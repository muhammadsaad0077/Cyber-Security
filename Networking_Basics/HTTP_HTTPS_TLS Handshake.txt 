Securing accounts:-

Wifi:- Encrypted connections means that information/packets you send is encrypted until it reached to source/destination.

HTTP:- It does not encrypt your packet and some person in the middle can steal the information.

Machine in the Middle Attacks: If your wifi is using HTTP, third party (machine in the middle) can inject anything in the response, for example you are using wifi of coffe shop and it is using http 
protocol so the coffe shop tech team can inject ads.js while sending the response back, every user will see on ads while using the websites (although the website itself does not have any adds).

Packet Sniffing: Your sent packets can be looked by a machine in the middle (in case of HTTP protocol) like what are you searching for e.g GET /search?q=tiger http
same is the case with POST call which is more dangerous e.g POST /checkout hhtp.  and you are posting your credit card to the server

It is not necesarry that you are connected to the same wifi in order to behave like middleman, you can use any other wifi or mobile data, but you have to be in that region and should have antenna that access
http packets.

Cookies: Virtual stamp to remember has you already visit/account on our website. These are saved in the browser and contain the session id, login token, user tracking.
Now if you are using http then comes the Session Hijacking, in this attacker can sniff your information and took the session id from it, and then make the API call to the same server providing your session id
and he may be logged as you on to that website.

HTTPS: Secure Protocol that uses SSL certificate (or modernly known as TLS certificate) to verify a website. These certificates are issued by CA (Certificate Authorities).

SSL Stripping: Suppose you enter a url with http://www.example.com and in response you are redirected to the url https://www.examp1e.com and by seeing https you are relaxed that I am secure but actually you are not,
the url you are redirected is the man/machine in the middle that changes l by 1 and you are thinking that you are safe. 


TLS Handshake:
How the encryption actually happens using HTTPS.
- At the first request, let's say called Client Hello, 5 things ( Current using Version of SSL/TLS, Random Number, Session ID, Ciphers, Extensions ) are transferred with the request.
- At the response of this request the server respond with Server Hello that includes also the 5 things.
- At the end of this first session both knows the highest version to use (e.g if client has current version 1.4 and server has 1.2 then the mutually highest version used will be 1.2).
- Also at the end they know which cipher suite to use (meaning that which registered CA company certificate the server has, while the client request all the registered CA sent to the server )
- Also both know each other random number, session id, and extensions if they are using any.

- After the server respond with certificate records, now the client have certificate records and public key (sent by server which is inside the certificate)

- After that server respond with Server Hello Done ( meaning that server has done from its side, the response if often empty ).

- Now the client ask two questions
Is it a valid certificate ? This is verified using CA public key and the signature available in the certificate.

Secondly the client ask is the server is the true owner of this certificate ? 
 This is going to verify in a way that client sends a request with a pre master secret key ( that is of 48 bytes, first 2 bytes contain mutually highest SSL version and other 46 bytes contain public key
 and then this is send with the request in the encrypted form, now the only true server can decrypt it as it will contain private key and true SSL version. 
 
 Now the both client and server has same pre master key/secret. This pre master key helps to make SEED Value (additional Session ID ) and the verification of actual owner.
 
 Now this pre master key/secret is used to drive master secret. This will be generated by combining client pre master secret, random number, server random number, the string "master secret", as both the sides have this information hence the master secret will be generated on both sides.
 
 Now this master secret is used to generate session keys that will actually involve in communication. This will be generated by combining master secret, server random, client random, and the string 
 "key expansion", and again both sides have this information so the sessions keys will be generated on both sides.
 
 Two key pairs are created on the both sides, 1- Client Encryption Key, Client HMAC Key  2- Server Encryption Key, Server HMAC Key. Two pairs are created because TLS creates two tunnel while communication that
 encrypts information from both sides ( and hence for decrypting two pairs should be available on both sides ). If an adversary somehow by brute force generates client key then it have only half communication
 information, server's side information is still safe.
 
 These keys are generated using PRF ( Pseudo Random Function ) algorithm, its kind of like hashing algorithm that generates digests at any desired length.
 
 This all process is called Client Key Exchange.
 
 Now at this stage both sides have generated all the secret/keys on its own, no one knows that we have the identical keys/secret or not. Well to verify this finished request send from the client that contain
 the encrypted verification secret/key ( this encrypted verification is generated by hashing all the communication and its content in handshake like from Client Hello, Server Hello, Certificate, Server hello Done,
 Client Key Exchange.  This all is hash to the handshake hash, now some other information is added to hanshake hash like master secret and the string "client finished", it passes to PRF algorithm to generate
 a Verification Data and then this verification data is encrypted by the client session keys and send to the server. Server now decrypts it and obtained the same result as client, this tells the server that client
 has same data as me.  
 
 But client still not know that the server has identical data, in order to confirm this server also do the same process as mentioned above.
 
 
 
 SSL Striping: This is a technique used by adversary to stay in the middle and fool the server that the connection is secure but in reality it is not a secure connection.
 
 To avoid this
 
 HSTS (HTTPS Strict Transport Security) was introduced that ensures a secure https connection always, basically when you visit a secure website for the first time it adds some information
 like max age = 24543433 (like for this time which is very enough you don't need to check this website again and again that it is millicious or not), include sub domains ( means that its sub domain are also safe ).
 Basically this HSTS forces user to use https
